
{% extends "common/sufee_themed_template.html" %}

{% block title %}{{server.botName}}{% endblock %}

{% block main %}


            <!--/.col-->
            <div class="container-fluid card-header border" >
                <strong class="card-title mb-3">Console logs</strong>
            </div>
            <div class="breadcrumbs">
                <div class="d-flex justify-content-center my-auto">
                    <div class="row">
                        <div class="col-4 col-sm-2">
                            <strong>Debug</strong>
                            <label class="switch switch-text switch-primary switch-pill" >
                                <input type="checkbox" class="switch-input" id="inp-Debug" checked="true" onclick="toggle_messages('Debug');">
                                <span data-on="On" data-off="Off" class="switch-label"></span>
                                <span class="switch-handle"></span>
                            </label>
                        </div>
                        <div class="col-4 col-sm-2">
                            <strong>Info</strong>
                            <label class="switch switch-text switch-info switch-pill" >
                                <input type="checkbox" class="switch-input" id="inp-Info" checked="true"  onclick="toggle_messages('Info');">
                                <span data-on="On" data-off="Off" class="switch-label"></span>
                                <span class="switch-handle"></span>
                            </label>
                        </div>
                        <div class="col-4 col-sm-2">
                            <strong>Warning</strong>
                            <label class="switch switch-text switch-warning switch-pill" >
                                <input type="checkbox" class="switch-input" id="inp-Warning" checked="true" onclick="toggle_messages('Warning');">
                                <span data-on="On" data-off="Off" class="switch-label"></span>
                                <span class="switch-handle"></span>
                            </label>
                        </div>
                        <div class="col-4 col-sm-2">
                            <strong>Error</strong>

                            <label class="switch switch-text switch-danger switch-pill" >
                                <input type="checkbox" class="switch-input" id="inp-Error" checked="true" onclick="toggle_messages('Error');">
                                <span data-on="On" data-off="Off" class="switch-label"></span>
                                <span class="switch-handle"></span>
                            </label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col col-lg mx-1 my-1">
                            <button id="display-server-state-button" type="button" onclick="get_server_state()"
                                                class="btn btn-sm btn-info btn-block"
                                                style="overwrite:none">
                                            <i class="fa fa-refresh fa-lg"></i>&nbsp;
                                            <span id="display-server-state-button-text" >State</span>
                                            <span id="display-server-state-button-sending" class="d-none">Requesting…</span>
                             </button> <br/>
                        </div>
                        <div class="col col-lg mx-1 my-1">
                            <button id="display-server-tasks-button" type="button" onclick="get_server_tasks()"
                                                class="btn btn-sm btn-info btn-block"
                                                style="overwrite:none">
                                            <i class="fa fa-tasks fa-android"></i>&nbsp;
                                            <span id="display-server-tasks-button-text" >Tasks</span>
                                            <span id="display-server-tasks-button-sending" class="d-none">Requesting…</span>
                             </button> <br/>
                        </div>
                        <div class="col col-lg mx-1 my-1 e">
                            <button id="display-server-threads-button" type="button" onclick="get_server_threads()"
                                                class="btn btn-sm btn-info btn-block"
                                                style="overwrite:none">
                                            <i class="fa fa-tasks fa-lg"></i>&nbsp;
                                            <span id="display-server-threads-button-text" >Threads</span>
                                            <span id="display-server-threads-button-sending" class="d-none">Requesting…</span>
                             </button> <br/>
                        </div>
                    </div>
                </div>
            </div>
            <div class="overflow-auto" >
                <div class="container-fluid bg-white border-bottom overflow-auto "   id="console">
                    <div id="dummyElement"></div>
                    {% for item in server.console_messages %}
                        {% with it=item %}
                            {% include 'public/view_logs/logs_line.html' %}
                        {% endwith %}
                    {% endfor %}
                </div>
            </div>
            <!--/.col-->
             <script type="text/javascript" charset="utf-8">

             </script>


{% endblock %}

{% block picture%}{% endblock %}

{% block pageScript %}
    <script type="text/javascript" charset="utf-8">
        var socket = io.connect('');
        socket.on('broadcasted console message', function() {
                jQuery("#dummyElement").after(arguments[0]);
                toggle_messages('Debug');
                toggle_messages('Info');
                toggle_messages('Warning');
                toggle_messages('Error');
            });

        function toggle_messages(type)
        {
            if(jQuery('#inp-'+ type).prop("checked") == true)
            {
               jQuery('div[name=cls-'+type+']').removeClass("d-none");
            }
            else
            {
                jQuery('div[name=cls-'+type+']').addClass("d-none");
            }
        }


                    function get_server_state()
                    {

                        jQuery("#display-server-state-button-text").toggleClass("d-none")
                        jQuery("#display-server-state-button-sending").toggleClass("d-none")
                        jQuery.ajax(
                            {
                                url: "/get_server_state",
                                success: function(result)
                                {
                                    console.log("server state requested")
                                    jQuery("#display-server-state-button-text").toggleClass("d-none")
                                    jQuery("#display-server-state-button-sending").toggleClass("d-none")
                                }
                            }
                        );

                    }

                    function get_server_tasks()
                    {
                        jQuery("#display-server-tasks-button-text").toggleClass("d-none")
                        jQuery("#display-server-tasks-button-sending").toggleClass("d-none")
                        jQuery.ajax(
                            {
                                url: "/get_server_tasks",
                                success: function(result)
                                {
                                    console.log("server tasks requested")
                                    jQuery("#display-server-tasks-button-text").toggleClass("d-none")
                                    jQuery("#display-server-tasks-button-sending").toggleClass("d-none")
                                }
                            }
                        );

                    }

                    function get_server_threads()
                    {
                        jQuery("#display-server-threads-button-text").toggleClass("d-none")
                        jQuery("#display-server-threads-button-sending").toggleClass("d-none")
                        jQuery.ajax(
                            {
                                url: "/get_server_threads",
                                success: function(result)
                                {
                                    console.log("server threads requested")
                                    jQuery("#display-server-threads-button-text").toggleClass("d-none")
                                    jQuery("#display-server-threads-button-sending").toggleClass("d-none")
                                }
                            }
                        );

                    }



    </script>
{% endblock %}


